<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarnView - Watch Ads & Earn Money</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-purple-600 via-blue-600 to-cyan-500 min-h-screen">
    <div class="container mx-auto px-4 py-12">
        <div class="max-w-md mx-auto bg-white rounded-2xl shadow-2xl p-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-2">EarnView</h1>
                <p class="text-gray-600">Watch ads, earn real money</p>
            </div>
            <div id="loginForm">
                <h2 class="text-2xl font-bold mb-6">Login</h2>
                <form onsubmit="handleLogin(event)">
                    <input type="email" id="loginEmail" required placeholder="Email" class="w-full px-3 py-2 border rounded-lg mb-4">
                    <input type="password" id="loginPassword" required placeholder="Password" class="w-full px-3 py-2 border rounded-lg mb-6">
                    <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 rounded-lg font-semibold">Login</button>
                </form>
                <p class="text-center mt-4"><a href="#" onclick="toggleForms()" class="text-blue-600">Register</a></p>
            </div>
            <div id="registerForm" style="display: none;">
                <h2 class="text-2xl font-bold mb-6">Register</h2>
                <form onsubmit="handleRegister(event)">
                    <input type="text" id="regUsername" required placeholder="Username" class="w-full px-3 py-2 border rounded-lg mb-4">
                    <input type="email" id="regEmail" required placeholder="Email" class="w-full px-3 py-2 border rounded-lg mb-4">
                    <input type="password" id="regPassword" required placeholder="Password" class="w-full px-3 py-2 border rounded-lg mb-4">
                    <input type="text" id="regReferral" placeholder="Referral Code (optional)" class="w-full px-3 py-2 border rounded-lg mb-6">
                    <button type="submit" class="w-full bg-gradient-to-r from-green-600 to-teal-600 text-white py-3 rounded-lg font-semibold">Register</button>
                </form>
                <p class="text-center mt-4"><a href="#" onclick="toggleForms()" class="text-blue-600">Login</a></p>
            </div>
        </div>
    </div>
    <script>
        const API_URL = '/api';
        function toggleForms() {
            document.getElementById('loginForm').style.display = document.getElementById('loginForm').style.display === 'none' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = document.getElementById('registerForm').style.display === 'none' ? 'block' : 'none';
        }
        async function handleLogin(e) {
            e.preventDefault();
            const response = await fetch(`${API_URL}/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: document.getElementById('loginEmail').value,
                    password: document.getElementById('loginPassword').value
                })
            });
            const data = await response.json();
            if (data.success) {
                localStorage.setItem('token', data.token);
                window.location.href = '/dashboard.html';
            } else {
                alert(data.error || 'Login failed');
            }
        }
        async function handleRegister(e) {
            e.preventDefault();
            const response = await fetch(`${API_URL}/auth/register`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    username: document.getElementById('regUsername').value,
                    email: document.getElementById('regEmail').value,
                    password: document.getElementById('regPassword').value,
                    referralCode: document.getElementById('regReferral').value
                })
            });
            const data = await response.json();
            if (data.success) {
                alert('Registration successful!');
                toggleForms();
            } else {
                alert(data.error || 'Registration failed');
            }
        }
    </script>
</body>
</html>